<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomodoro Clock</title>
    <link rel="stylesheet" href="assets/css/styles.css">
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-4"></div>
        <div class="col-4">
          <section id="clock">
            <div id="control-panel">
              <span id="name">Task time</span>
              <div id="time-segment">
                <span id="min-10s" class="time-display"><span class="num">0</span></span>
                <span id="min-1s" class="time-display"><span class="num">0</span></span>
                <span class="time-display" class="time-display">:</span>
                <span id="sec-10s" class="time-display"><span class="num">0</span></span>
                <span id="sec-1s" class="time-display"><span class="num">0</span></span>
              </div>
              Task
              <input id="task" type="number" value="45" placeholder="Enter task time in minutes" min="15" max="60">
              Rest
              <input id="rest" type="number" value="15" placeholder="Enter task time in minutes" min="5" max="15">            
              <button id="start" >start</button>  
            </div>
          </section>
        </div>
        <div class="col-4"></div>                
      </div>
    </div>
    <script>
      var start = document.getElementById('start');
      var task = document.getElementById('task');
      var rest = document.getElementById('rest');
      var display = document.getElementById('display');

      function parseCounter(counter){

        var obj = Object.create(null);
        obj.seconds = Object.create(null);
        obj.minutes = Object.create(null);

        if (value - 10 < 0){
          obj.seconds.ones = counter;
          
        }
        else if (value - 10 > -1 && value - 60 < 0) {
          time = "00:" + value;
        }
        else if (value >= 60 && value < 600){
          time = "0" + String(Math.floor(value/60)) + ":";
          var mod = value % 60;
          if (mod < 10){
            time += "0" + String(mod);
          } else {
            time += mod;
          }  
        }
        else {
          time = String(Math.floor(value/60)) + ":";
          var mod = value % 60;
          if (mod < 10){
            time += "0" + String(mod);
          } else {
            time += mod;
          }  
        }

        display.innerHTML = phase + ': ' + time;
      }

      var timekeeper = {
        counter: 1,
        task: {
          duration: 10,
          output: displayCount,
        },
        rest: {
          duration: 5,
          output: displayCount,
        },
        phases: ['task', 'rest'],
        timer: undefined
      }
      var timer = pomodoro(timekeeper)

      start.addEventListener("click", function(){
        timer.setDurations(task.value, rest.value);
        timer.start();
      })

      function pomodoro(timekeeper) {

        var obj = Object.assign({}, timekeeper);
        var phase = obj.phases.shift();
        var _initial = obj.counter;
        obj.phases.push(phase);

        return {
          setDurations: function setDurations(t, r){
            obj.task.duration = Number(t) * 60;
            obj.rest.duration = Number(r) * 60;
          },
          start: function start(){
            obj.counter = _initial;
            
            if (obj.timer !== undefined){
              clearInterval(obj.timer);
            }

            obj.timer = setInterval(function timerFn() {
              
              if (obj.counter >= obj[phase].duration){
                phase = obj.phases.shift();
                obj.phases.push(phase);
                obj.counter = 0;
              }

              obj.counter++;
              obj[phase].output(obj.counter, phase);
              return timerFn;
            }, 1000);
          }
        }
      }

    </script>
  </body>
</html>